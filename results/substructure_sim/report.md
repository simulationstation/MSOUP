# Msoup Substructure Simulation: Domain/Pocket Distinguishability

Generated: 2025-12-20 07:54:53

## Executive Summary

This simulation tests whether 'domain/pocket' dark structure (Msoup case-2)
produces distinguishable substructure statistics compared to a Poisson baseline.

### Key Findings

**At N = 10000 lenses:**

| Model | Fano Factor | Clustering C | Meaning |
|-------|-------------|--------------|---------|
| Poisson | 1.059 | 0.0957 | CDM-like baseline |
| Cox | 1.593 | 0.0904 | Over-dispersion only |
| Cluster | 1.353 | 0.3204 | Pockets (both effects) |

### Discriminability

**Cox vs Poisson:**
- Fano difference: 0.534 (z = 12.13, p = 0.0000)
- Clustering difference: -0.0054 (z = -0.52, p = 0.6059)

**Cluster vs Poisson:**
- Fano difference: 0.294 (z = 9.86, p = 0.0000)
- Clustering difference: 0.2246 (z = 16.10, p = 0.0000)

## Model Interpretation (in M terms)

### Poisson Model (CDM-like)
- Independent M~2 subhalos scattered uniformly around the Einstein ring
- Variance = Mean (Fano factor ≈ 1)
- No spatial clustering beyond random

### Cox Model (Lens-to-lens variation)
- Each lens has a different 'domain state' affecting local subhalo abundance
- Creates over-dispersion (Fano > 1) without spatial clustering
- Represents lens-to-lens intermittency but not within-lens clustering

### Cluster Model (Domain pockets)
- Rare M>2 'domain pockets' spawn clusters of perturbers
- Creates BOTH over-dispersion AND spatial clustering along the arc
- **This is the true 'pocket smoking gun'**

## Critical Insight

**The true domain/pocket signature is NOT just over-dispersion.**

- Cox model shows Fano > 1 but clustering C ≈ uniform
- Cluster model shows Fano > 1 AND clustering C > uniform

If real data shows high Fano but normal clustering → could be explained by
host-to-host variation (Cox-like), not pockets.

If real data shows high Fano AND high clustering → stronger evidence for pockets.

## Sample Size Requirements

### Fano Factor Detection

**Cox vs Poisson:**
- N = 100: Fano p = 0.0765 (not detectable)
- N = 300: Fano p = 0.0070 (DETECTABLE)
- N = 1000: Fano p = 0.0006 (DETECTABLE)
- N = 3000: Fano p = 0.0000 (DETECTABLE)
- N = 10000: Fano p = 0.0000 (DETECTABLE)

**Cluster vs Poisson:**
- N = 100: Fano p = 0.8752 (not detectable)
- N = 300: Fano p = 0.0191 (DETECTABLE)
- N = 1000: Fano p = 0.0003 (DETECTABLE)
- N = 3000: Fano p = 0.0000 (DETECTABLE)
- N = 10000: Fano p = 0.0000 (DETECTABLE)

### Clustering Detection

**Cox vs Poisson:**
- N = 100: Clustering p = 0.7585 (not detectable)
- N = 300: Clustering p = 0.7565 (not detectable)
- N = 1000: Clustering p = 0.0010 (DETECTABLE)
- N = 3000: Clustering p = 0.7648 (not detectable)
- N = 10000: Clustering p = 0.7419 (not detectable)

**Cluster vs Poisson:**
- N = 100: Clustering p = 0.1676 (not detectable)
- N = 300: Clustering p = 0.0008 (DETECTABLE)
- N = 1000: Clustering p = 0.0000 (DETECTABLE)
- N = 3000: Clustering p = 0.0000 (DETECTABLE)
- N = 10000: Clustering p = 0.0000 (DETECTABLE)

## Degeneracy Warning

**Cox can mimic Fano but NOT clustering:**
- If you only measure over-dispersion (Fano > 1), you cannot distinguish
  Cox (host variation) from Cluster (pockets)

**Host-to-host scatter can explain high Fano:**
- Even after conditioning on observed host properties (H, z), unobserved
  scatter can create Fano > 1
- This is NOT evidence for pockets

**Spatial clustering is the discriminating signal:**
- Cluster model elevates C above uniform expectation
- Cox model does NOT affect C
- This is why clustering metric is essential

## Technical Details

| Parameter | Value |
|-----------|-------|
| Runtime | -0.96 s |
| Mean perturbers/lens | 0.57 |
| N_lenses | 10000 |
| Clustering threshold θ₀ | 0.3 rad |
| Expected C (uniform) | 0.0955 |

---

*Report generated by msoup_substructure_sim*